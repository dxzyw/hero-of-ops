prometheus如何面对日益增长的数据量？thonas实现低成本海量存储。

在开始之前，我们先来回顾下prometheus的存储机制。

prometeus的数据以 2 小时为一个 block 存储，每个block有索引支持快速查询，的默认保留时间为15天，虽然可以通过参数调整存储的时间，但是对于大量增长的数据量，如果要查询较长时间的数据查询时需要扫描更大范围的数据block，这会导致查询效率的下降。

Prometheus 重启时需要扫描本地 TSDB block 进行 WAL（写前日志）恢复，数据量越大，恢复时间越长，可能从几分钟变成几十分钟甚至更久。

如果 Prometheus 长时间存储数据（数月甚至数年），会出现：

- 磁盘爆满
- 查询变慢
- 内存占用增加
- 重启时间过长
- 数据容易丢失

因此在生产上，更建议采用远程存储，如利用thanos、victoriaMetrics等实现。

今天介绍的就是利用thanos实现数据存储到对象存储，那么为什么是对象存储呢？因为对象存储 = 无限容量 + 低成本

关于thanos的sidecar和querier，介绍可以参考前面的文章。

## 部署minio用做存储

## 


